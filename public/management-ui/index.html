<!DOCTYPE html>
<html>

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="<%= description %>">
    <meta name="author" content="<%= author %>">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" integrity="sha384-Zug+QiDoJOrZ5t4lssLdxGhVrurbmBWopoEl+M6BdEfwnCJZtKxi1KgxUyJq13dy"
        crossorigin="anonymous">

    <!-- Custom styles for this template -->
    <link href="<%= managementPath %>/css/styles.css" rel="stylesheet">

    <!-- Vue.js -->
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue-resource"></script>
    <script src="https://unpkg.com/vue-router/dist/vue-router.js"></script>

    <!-- Moment -->
    <script src="https://momentjs.com/downloads/moment.js"></script>

    <title>
        <%= title %> - <%= version %>
    </title>
</head>

<body>
    <div id="app">
        <header>
            <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
                <a class="navbar-brand" href="<%= managementPath %>">Schedule Management</a>
                <button class="navbar-toggler d-lg-none" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </nav>
        </header>

        <div class="container-fluid">
            <div class="row">
                <nav class="col-sm-3 col-md-2 d-none d-sm-block bg-light sidebar">
                    <ul class="nav nav-pills flex-column">
                        <li class="nav-item">
                            <router-link to="/job">Job</router-link>
                            <span class="sr-only">(current)</span>
                        </li>
                        <li class="nav-item">
                            <router-link to="/log">Log</router-link>
                        </li>
                    </ul>

                    <ul class="nav nav-pills flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="#">Logout</a>
                        </li>
                    </ul>
                </nav>

                <router-view :key="$route.fullPath"></router-view>

                <script type="text/x-template" id="jobs">
                    <main role="main" class="col-sm-9 ml-sm-auto col-md-10 pt-3">
                        <div>
                            <div class="float-left"><h2>Jobs</h2></div>
                            <div class="float-right">
                                <button type="button" class="btn btn-success" data-toggle="modal" data-target="#newJobModal">New Job</button>
                                <Page v-bind:maxPage="maxPage" path="/job" v-bind:nowPage="$route.params.page"></Page>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Cron Time</th>
                                        <th>Request</th>
                                        <th>Time Zone</th>
                                        <th>Running</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <jobs-list v-bind:job="job" v-bind:index="index" v-for="(job, index) in jobs"></jobs-list>
                                </tbody>
                            </table>
                        </div>
                    </main>
                </script>

                <script type="text/x-template" id="logs">
                    <main role="main" class="col-sm-9 ml-sm-auto col-md-10 pt-3">
                        <div>
                            <div class="float-left"><h2>Logs</h2></div>
                            <div class="float-right">
                                <Page v-bind:maxPage="maxPage" path="/log" v-bind:nowPage="$route.params.page"></Page>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Timestamp</th>
                                        <th>Name</th>
                                        <th>Success</th>
                                        <th>Result</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <logs-list v-bind:log="log" v-bind:index="index" v-for="(log, index) in logs"></logs-list>
                                </tbody>
                            </table>
                        </div>
                    </main>
                </script>

                <div class="modal fade bd-example-modal-lg" id="newJobModal" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">New Job</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <form>
                                    <div class="form-group row">
                                        <label for="staticEmail" class="col-sm-2 col-form-label">Name</label>
                                        <div class="col-sm-10">
                                            <div class="input-group mb-3">
                                                <input type="text" class="form-control" v-model="name">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label for="staticEmail" class="col-sm-2 col-form-label">Cron Time</label>
                                        <div class="col-sm-10">
                                            <div class="input-group mb-3">
                                                <div class="input-group-prepend">
                                                    <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{ timezone }}</button>
                                                    <div class="dropdown-menu">
                                                        <a class="dropdown-item" href="#" v-for="timezone in timezones" @click="changeTimezone(timezone)">{{ timezone }}</a>
                                                    </div>
                                                </div>
                                                <input type="text" class="form-control" placeholder="* * * * *" v-model="cronTime">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label for="staticEmail" class="col-sm-2 col-form-label">Request URL</label>
                                        <div class="col-sm-10">
                                            <div class="input-group mb-3">
                                                <div class="input-group-prepend">
                                                    <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{ method }}</button>
                                                    <div class="dropdown-menu">
                                                        <a class="dropdown-item" href="#" @click="changeMethod('GET')">GET</a>
                                                        <a class="dropdown-item" href="#" @click="changeMethod('POST')">POST</a>
                                                        <a class="dropdown-item" href="#" @click="changeMethod('PUT')">PUT</a>
                                                        <a class="dropdown-item" href="#" @click="changeMethod('DELETE')">DELETE</a>
                                                    </div>
                                                </div>
                                                <input type="text" class="form-control" placeholder="http://xxx.xxx.xxx" v-model="url">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="exampleFormControlTextarea1">Request Header</label>
                                        <textarea class="form-control" id="" rows="3" v-model="header"></textarea>
                                    </div>
                                    <div class="form-group">
                                        <label for="exampleFormControlTextarea1">Request Body</label>
                                        <textarea class="form-control" id="" rows="3" v-model="body"></textarea>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" @click="createJob">Create</button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/js/bootstrap.min.js" integrity="sha384-a5N7Y/aK3qNeh15eJKGWxsqtnX/wWdSZSKp+81YjTmS15nvnvxKHuzaWwXHDli+4"
        crossorigin="anonymous"></script>

    <!-- Vue Content -->
    <script type="text/javascript">
        /* Pass the management path to frontend */
        const managementPath = '<%= managementPath %>';
    </script>
    <!-- Vue Components -->
    <script src="<%= managementPath %>/js/components/page.js"></script>
    <script src="<%= managementPath %>/js/components/job.js"></script>
    <script src="<%= managementPath %>/js/components/log.js"></script>
    <script src="<%= managementPath %>/js/index.js"></script>
</body>

</html>